/*!
 * crclrrr - version 0.1.0
 *
 * Made with ‚ù§ by Steve Ottoz so@dev.so
 *
 * Copyright (c) 2018 Steve Ottoz
 */
(function(a,b){if('function'==typeof define&&define.amd)define(['module','exports'],b);else if('undefined'!=typeof exports)b(module,exports);else{var c={exports:{}};b(c,c.exports),a.Crclrrr=c.exports}})(this,function(a,b){'use strict';function c(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(b,'__esModule',{value:!0});var d='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f={size:40,border:3,round:!0,bg:'ghostwhite',progress:'lightgreen',duration:1500,baseClass:'crclrrr',initial:0,easing:function(a){return a}},g=function(){function a(b){var d=Math.floor,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};c(this,a),this.el=b instanceof Node?b:document.querySelector(b),this.options=Object.assign({},f,e),this._defaults=f,this.callbacks={},this.ns='http://www.w3.org/2000/svg',this.svg=this.el.querySelector('.'+this.options.baseClass),this.bg=this.el.querySelector('.'+this.options.baseClass+'-bg'),this.progress=this.el.querySelector('.'+this.options.baseClass+'-progress'),this.svg||(this.svg=document.createElementNS(this.ns,'svg'),this.el.appendChild(this.svg)),this.bg||(this.bg=document.createElementNS(this.ns,'circle'),this.svg.appendChild(this.bg)),this.progress||(this.progress=document.createElementNS(this.ns,'circle'),this.svg.appendChild(this.progress)),this.svg.setAttribute('class',this.options.baseClass),this.svg.setAttribute('viewBox','0 0 '+this.options.size+' '+this.options.size),this.svg.style.transform='rotate(-90deg)',this.bg.setAttribute('class',this.options.baseClass+'-bg'),this.bg.setAttribute('cx',this.options.size/2),this.bg.setAttribute('cy',this.options.size/2),this.bg.setAttribute('r',d((this.options.size-this.options.border)/2)),this.bg.style.fill='transparent',this.bg.style.opacity=1,this.bg.style.stroke=this.options.bg,this.bg.style.strokeWidth=this.options.border,this.bg.style.strokeLinecap=this.options.round?'round':'butt',this.progress.setAttribute('class',this.options.baseClass+'-progress'),this.progress.setAttribute('cx',this.options.size/2),this.progress.setAttribute('cy',this.options.size/2),this.progress.setAttribute('r',d((this.options.size-this.options.border)/2)),this.progress.style.fill='transparent',this.progress.style.opacity=0,this.progress.style.stroke=this.options.progress,this.progress.style.strokeWidth=this.options.border,this.progress.style.strokeLinecap=this.options.round?'round':'butt','function'==typeof window.CustomEvent?this.event=new CustomEvent(this.options.baseClass+'-complete',{bubbles:!0,cancelable:!0}):(this.event=document.createEvent('Event'),this.event.initEvent(this.options.baseClass+'-complete',!0,!0)),this.init()}var b=Math.min,g=Math.max;return e(a,[{key:'init',value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options.initial;return this.radius=this.progress.getAttribute('r'),this.totalLength=Math.PI*(2*this.radius),this.current=a,this.from=0,this.to=0,this.start=0,this.frame=0,this.progress.style.strokeDasharray=this.totalLength,this._draw(),this}},{key:'_animate',value:function(){var a=Math.round,b=Date.now(),c=(b-this.start)/this.duration||0,d=this.options.easing(c);if(this.current>=this.to){if(this.up)return!1;this.current=a(this.from-(this.from-this.to)*d)}else if(this.current<=this.to){if(!this.up)return!1;this.current=a(this.from+(this.to-this.from)*d)}this._draw(),this.frame=window.requestAnimationFrame(this._animate.bind(this))}},{key:'_draw',value:function(){var a=(100-this.current)/100*this.totalLength;if(this.progress.style.opacity=1,this.progress.style.strokeDashoffset=b(g(a,0),this.totalLength),100<=this.current&&(this.el.classList.remove('loading'),this.el.dispatchEvent(this.event),Array.isArray(this.callbacks.complete))){var c,e=!0,f=!1;try{for(var h,i,j=this.callbacks.complete[Symbol.iterator]();!(e=(h=j.next()).done);e=!0)i=h.value,/^f/.test('undefined'==typeof i?'undefined':d(i))&&i.apply(this,[this])}catch(a){f=!0,c=a}finally{try{!e&&j.return&&j.return()}finally{if(f)throw c}}}}},{key:'on',value:function(a,b){return Array.isArray(this.callbacks[a])||(this.callbacks[a]=[]),this.callbacks[a].push(b),this}},{key:'reset',value:function(a){return this.init(a),this.el.classList.remove('loading'),this}},{key:'destroy',value:function(){this.el.classList.remove('loading'),this.el.removeChild(this.svg)}},{key:'value',set:function(a){this.from=g(this.current,0),this.to=b(+a,100),this.up=this.from<this.to,this.start=Date.now(),this.duration=this.up?(this.to-this.from)*(this.options.duration/100):(this.from-this.to)*(this.options.duration/100),this.el.classList.add('loading'),window.cancelAnimationFrame(this.frame),this._animate()},get:function(){return this.current}}]),a}();b.default=g,a.exports=b['default']});