/*!
 * crclrrr - version 0.4.0
 *
 * Made with ‚ù§ by Steve Ottoz so@dev.so
 *
 * Copyright (c) 2020 Steve Ottoz
 */
!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):(t="undefined"!=typeof globalThis?globalThis:t||self).Crclrrr=s()}(this,(function(){"use strict";function t(s){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(s)}function s(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function i(t,s){for(var i=0;i<s.length;i++){var e=s[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function e(t,s){(null==s||s>t.length)&&(s=t.length);for(var i=0,e=new Array(s);i<s;i++)e[i]=t[i];return e}function r(t,s){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,s){if(t){if("string"==typeof t)return e(t,s);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,s):void 0}}(t))||s&&t&&"number"==typeof t.length){i&&(t=i);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,h=!0,a=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return h=t.done,t},e:function(t){a=!0,n=t},f:function(){try{h||null==i.return||i.return()}finally{if(a)throw n}}}}var o={size:40,border:3,round:!0,bg:"ghostwhite",progress:"lightgreen",duration:1500,baseClass:"crclrrr",initial:0,easing:function(t){return t}};return function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,e),this.el=t instanceof Node?t:document.querySelector(t),this.options=Object.assign({},o,i),this._defaults=o,this.callbacks={},this.ns="http://www.w3.org/2000/svg",this.svg=this.el.querySelector(".".concat(this.options.baseClass)),this.bg=this.el.querySelector(".".concat(this.options.baseClass,"-bg")),this.progress=this.el.querySelector(".".concat(this.options.baseClass,"-progress")),this.svg||(this.svg=document.createElementNS(this.ns,"svg"),this.el.appendChild(this.svg)),this.bg||(this.bg=document.createElementNS(this.ns,"circle"),this.svg.appendChild(this.bg)),this.progress||(this.progress=document.createElementNS(this.ns,"circle"),this.svg.appendChild(this.progress)),this.svg.setAttribute("class",this.options.baseClass),this.svg.setAttribute("viewBox","0 0 ".concat(this.options.size," ").concat(this.options.size)),this.svg.style.transform="rotate(-90deg)",this.bg.setAttribute("class","".concat(this.options.baseClass,"-bg")),this.bg.setAttribute("cx",this.options.size/2),this.bg.setAttribute("cy",this.options.size/2),this.bg.setAttribute("r",Math.floor((this.options.size-this.options.border)/2)),this.bg.style.fill="transparent",this.bg.style.opacity=1,this.bg.style.stroke=this.options.bg,this.bg.style.strokeWidth=this.options.border,this.bg.style.strokeLinecap=this.options.round?"round":"butt",this.progress.setAttribute("class","".concat(this.options.baseClass,"-progress")),this.progress.setAttribute("cx",this.options.size/2),this.progress.setAttribute("cy",this.options.size/2),this.progress.setAttribute("r",Math.floor((this.options.size-this.options.border)/2)),this.progress.style.fill="transparent",this.progress.style.opacity=0,this.progress.style.stroke=this.options.progress,this.progress.style.strokeWidth=this.options.border,this.progress.style.strokeLinecap=this.options.round?"round":"butt",this.init()}var n,h,a;return n=e,(h=[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.initial;return this.radius=this.progress.getAttribute("r"),this.totalLength=Math.PI*(2*this.radius),this.current=t,this.from=0,this.to=0,this.start=0,this.frame=0,this.progress.style.strokeDasharray=this.totalLength,this._draw(),this}},{key:"_animate",value:function(){var s=(Date.now()-this.start)/this.duration||0,i=this.options.easing(s);if(this.current===this.to){if((this.up&&100!==this.to||!this.up&&0!==this.to)&&Array.isArray(this.callbacks.animated)){var e,o=r(this.callbacks.animated);try{for(o.s();!(e=o.n()).done;){var n=e.value;/^f/.test(t(n))&&n.apply(this,[this])}}catch(t){o.e(t)}finally{o.f()}}return!1}if(this.current>this.to){if(this.up)return!1;this.current=Math.max(Math.min(Math.round(this.from-(this.from-this.to)*i),this.from),this.to)}else if(this.current<this.to){if(!this.up)return!1;this.current=Math.max(Math.min(Math.round(this.from+(this.to-this.from)*i),this.to),this.from)}this._draw(),this.frame=window.requestAnimationFrame(this._animate.bind(this))}},{key:"_draw",value:function(){var s=(100-this.current)/100*this.totalLength;if(this.progress.style.opacity=Math.max(Math.min(this.current,1),0),this.progress.style.strokeDashoffset=Math.min(Math.max(s,0),this.totalLength),(this.up&&this.current>=100||!this.up&&this.current<=0)&&(this.el.classList.remove("loading"),Array.isArray(this.callbacks.complete))){var i,e=r(this.callbacks.complete);try{for(e.s();!(i=e.n()).done;){var o=i.value;/^f/.test(t(o))&&o.apply(this,[this])}}catch(t){e.e(t)}finally{e.f()}}}},{key:"on",value:function(t,s){return Array.isArray(this.callbacks[t])||(this.callbacks[t]=[]),this.callbacks[t].push(s),this}},{key:"reset",value:function(t){return this.init(t),this.el.classList.remove("loading"),this}},{key:"destroy",value:function(){this.el.classList.remove("loading"),this.el.removeChild(this.svg)}},{key:"value",set:function(t){this.from=Math.max(this.current,0),this.to=Math.min(+t,100),this.up=this.from<this.to,this.start=Date.now(),this.up?this.duration=(this.to-this.from)*(this.options.duration/100):this.duration=(this.from-this.to)*(this.options.duration/100),this.el.classList.add("loading"),window.cancelAnimationFrame(this.frame),this._animate()},get:function(){return this.current}}])&&i(n.prototype,h),a&&i(n,a),e}()}));
